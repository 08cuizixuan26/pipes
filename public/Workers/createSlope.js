define(function(){"use strict";function I(t){return null!=t}function o(t){var e;this.name="DeveloperError",this.message=t;try{throw new Error}catch(t){e=t.stack}this.stack=e}I(Object.create)&&((o.prototype=Object.create(Error.prototype)).constructor=o),o.prototype.toString=function(){var t=this.name+": "+this.message;return I(this.stack)&&(t+="\n"+this.stack.toString()),t},o.throwInstantiationError=function(){throw new o("This function defines an interface and should not be called directly.")};var i={};function n(t,e,n){return"Expected "+n+" to be typeof "+e+", actual typeof was "+t}function m(t,e){return null!=t?t:e}function e(t){null==t&&(t=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(t)}i.typeOf={},i.defined=function(t,e){if(!I(e))throw new o(t+" is required, actual value was undefined")},i.typeOf.func=function(t,e){if("function"!=typeof e)throw new o(n(typeof e,"function",t))},i.typeOf.string=function(t,e){if("string"!=typeof e)throw new o(n(typeof e,"string",t))},i.typeOf.number=function(t,e){if("number"!=typeof e)throw new o(n(typeof e,"number",t))},i.typeOf.number.lessThan=function(t,e,n){if(i.typeOf.number(t,e),n<=e)throw new o("Expected "+t+" to be less than "+n+", actual value was "+e)},i.typeOf.number.lessThanOrEquals=function(t,e,n){if(i.typeOf.number(t,e),n<e)throw new o("Expected "+t+" to be less than or equal to "+n+", actual value was "+e)},i.typeOf.number.greaterThan=function(t,e,n){if(i.typeOf.number(t,e),e<=n)throw new o("Expected "+t+" to be greater than "+n+", actual value was "+e)},i.typeOf.number.greaterThanOrEquals=function(t,e,n){if(i.typeOf.number(t,e),e<n)throw new o("Expected "+t+" to be greater than or equal to"+n+", actual value was "+e)},i.typeOf.object=function(t,e){if("object"!=typeof e)throw new o(n(typeof e,"object",t))},i.typeOf.bool=function(t,e){if("boolean"!=typeof e)throw new o(n(typeof e,"boolean",t))},i.typeOf.number.equals=function(t,e,n,r){if(i.typeOf.number(t,n),i.typeOf.number(e,r),n!==r)throw new o(t+" must be equal to "+e+", the actual values are "+n+" and "+r)},m.EMPTY_OBJECT=Object.freeze({}),e.prototype.init_genrand=function(t){for(this.mt[0]=t>>>0,this.mti=1;this.mti<this.N;this.mti++){t=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&t)>>>16)<<16)+1812433253*(65535&t)+this.mti,this.mt[this.mti]>>>=0}},e.prototype.genrand_int32=function(){var t,e,n=new Array(0,this.MATRIX_A);if(this.mti>=this.N){for(this.mti==this.N+1&&this.init_genrand(5489),e=0;e<this.N-this.M;e++)t=this.mt[e]&this.UPPER_MASK|this.mt[e+1]&this.LOWER_MASK,this.mt[e]=this.mt[e+this.M]^t>>>1^n[1&t];for(;e<this.N-1;e++)t=this.mt[e]&this.UPPER_MASK|this.mt[e+1]&this.LOWER_MASK,this.mt[e]=this.mt[e+(this.M-this.N)]^t>>>1^n[1&t];t=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^t>>>1^n[1&t],this.mti=0}return t=this.mt[this.mti++],t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,(t^=t>>>18)>>>0},e.prototype.random=function(){return this.genrand_int32()*(1/4294967296)};var S={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536,FOUR_GIGABYTES:4294967296};S.sign=m(Math.sign,function(t){return 0===(t=+t)||t!=t?t:0<t?1:-1}),S.signNotZero=function(t){return t<0?-1:1},S.toSNorm=function(t,e){return e=m(e,255),Math.round((.5*S.clamp(t,-1,1)+.5)*e)},S.fromSNorm=function(t,e){return e=m(e,255),S.clamp(t,0,e)/e*2-1},S.normalize=function(t,e,n){return 0===(n=Math.max(n-e,0))?0:S.clamp((t-e)/n,0,1)},S.sinh=m(Math.sinh,function(t){return(Math.exp(t)-Math.exp(-t))/2}),S.cosh=m(Math.cosh,function(t){return(Math.exp(t)+Math.exp(-t))/2}),S.lerp=function(t,e,n){return(1-n)*t+n*e},S.PI=Math.PI,S.ONE_OVER_PI=1/Math.PI,S.PI_OVER_TWO=Math.PI/2,S.PI_OVER_THREE=Math.PI/3,S.PI_OVER_FOUR=Math.PI/4,S.PI_OVER_SIX=Math.PI/6,S.THREE_PI_OVER_TWO=3*Math.PI/2,S.TWO_PI=2*Math.PI,S.ONE_OVER_TWO_PI=1/(2*Math.PI),S.RADIANS_PER_DEGREE=Math.PI/180,S.DEGREES_PER_RADIAN=180/Math.PI,S.RADIANS_PER_ARCSECOND=S.RADIANS_PER_DEGREE/3600,S.toRadians=function(t){return t*S.RADIANS_PER_DEGREE},S.toDegrees=function(t){return t*S.DEGREES_PER_RADIAN},S.convertLongitudeRange=function(t){var e=S.TWO_PI,t=t-Math.floor(t/e)*e;return t<-Math.PI?t+e:t>=Math.PI?t-e:t},S.clampToLatitudeRange=function(t){return S.clamp(t,-1*S.PI_OVER_TWO,S.PI_OVER_TWO)},S.negativePiToPi=function(t){return S.zeroToTwoPi(t+S.PI)-S.PI},S.zeroToTwoPi=function(t){var e=S.mod(t,S.TWO_PI);return Math.abs(e)<S.EPSILON14&&Math.abs(t)>S.EPSILON14?S.TWO_PI:e},S.mod=function(t,e){return(t%e+e)%e},S.equalsEpsilon=function(t,e,n,r){n=m(n,0),r=m(r,n);var i=Math.abs(t-e);return i<=r||i<=n*Math.max(Math.abs(t),Math.abs(e))},S.lessThan=function(t,e,n){return t-e<-n},S.lessThanOrEquals=function(t,e,n){return t-e<n},S.greaterThan=function(t,e,n){return n<t-e},S.greaterThanOrEquals=function(t,e,n){return-n<t-e};var a=[1];S.factorial=function(t){var e=a.length;if(e<=t)for(var n=a[e-1],r=e;r<=t;r++){var i=n*r;a.push(i),n=i}return a[t]},S.incrementWrap=function(t,e,n){return n=m(n,0),t=e<++t?n:t},S.isPowerOfTwo=function(t){return 0!==t&&0==(t&t-1)},S.nextPowerOfTwo=function(t){return--t,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t},S.clamp=function(t,e,n){return t<e?e:n<t?n:t};var r=new e;function E(t,e,n){this.x=m(t,0),this.y=m(e,0),this.z=m(n,0)}S.setRandomNumberSeed=function(t){r=new e(t)},S.nextRandomNumber=function(){return r.random()},S.randomBetween=function(t,e){return S.nextRandomNumber()*(e-t)+t},S.acosClamped=function(t){return Math.acos(S.clamp(t,-1,1))},S.asinClamped=function(t){return Math.asin(S.clamp(t,-1,1))},S.chordLength=function(t,e){return 2*e*Math.sin(.5*t)},S.logBase=function(t,e){return Math.log(t)/Math.log(e)},S.cbrt=m(Math.cbrt,function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}),S.log2=m(Math.log2,function(t){return Math.log(t)*Math.LOG2E}),S.fog=function(t,e){e*=t;return 1-Math.exp(-e*e)},S.fastApproximateAtan=function(t){return t*(-.1784*Math.abs(t)-.0663*t*t+1.0301)},S.fastApproximateAtan2=function(t,e){var n=Math.abs(t),r=Math.abs(e),i=Math.max(n,r);r=Math.min(n,r);n=S.fastApproximateAtan(r/i);return n=Math.abs(e)>Math.abs(t)?S.PI_OVER_TWO-n:n,n=t<0?S.PI-n:n,n=e<0?-n:n},E.fromSpherical=function(t,e){I(e)||(e=new E);var n=t.clock,r=t.cone,i=m(t.magnitude,1),t=i*Math.sin(r);return e.x=t*Math.cos(n),e.y=t*Math.sin(n),e.z=i*Math.cos(r),e},E.fromElements=function(t,e,n,r){return I(r)?(r.x=t,r.y=e,r.z=n,r):new E(t,e,n)},E.fromCartesian4=E.clone=function(t,e){if(I(t))return I(e)?(e.x=t.x,e.y=t.y,e.z=t.z,e):new E(t.x,t.y,t.z)},E.packedLength=3,E.pack=function(t,e,n){return n=m(n,0),e[n++]=t.x,e[n++]=t.y,e[n]=t.z,e},E.unpack=function(t,e,n){return e=m(e,0),(n=!I(n)?new E:n).x=t[e++],n.y=t[e++],n.z=t[e],n},E.packArray=function(t,e){var n=t.length,r=3*n;if(I(e)){if(!Array.isArray(e)&&e.length!==r)throw new o("If result is a typed array, it must have exactly array.length * 3 elements");e.length!==r&&(e.length=r)}else e=new Array(r);for(var i=0;i<n;++i)E.pack(t[i],e,3*i);return e},E.unpackArray=function(t,e){var n=t.length;I(e)?e.length=n/3:e=new Array(n/3);for(var r=0;r<n;r+=3){var i=r/3;e[i]=E.unpack(t,r,e[i])}return e},E.fromArray=E.unpack,E.maximumComponent=function(t){return Math.max(t.x,t.y,t.z)},E.minimumComponent=function(t){return Math.min(t.x,t.y,t.z)},E.minimumByComponent=function(t,e,n){return n.x=Math.min(t.x,e.x),n.y=Math.min(t.y,e.y),n.z=Math.min(t.z,e.z),n},E.maximumByComponent=function(t,e,n){return n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.z=Math.max(t.z,e.z),n},E.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y+t.z*t.z},E.magnitude=function(t){return Math.sqrt(E.magnitudeSquared(t))};var u=new E;E.distance=function(t,e){return E.subtract(t,e,u),E.magnitude(u)},E.distanceSquared=function(t,e){return E.subtract(t,e,u),E.magnitudeSquared(u)},E.normalize=function(t,e){var n=E.magnitude(t);return 0!=n?(e.x=t.x/n,e.y=t.y/n,e.z=t.z/n):E.clone(t,e),Math.abs(e.x)<S.EPSILON8&&(e.x=0),Math.abs(e.y)<S.EPSILON8&&(e.y=0),Math.abs(e.z)<S.EPSILON8&&(e.z=0),e},E.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},E.multiplyComponents=function(t,e,n){return n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z,n},E.divideComponents=function(t,e,n){return n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z,n},E.add=function(t,e,n){return n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n},E.subtract=function(t,e,n){return n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n},E.multiplyByScalar=function(t,e,n){return n.x=t.x*e,n.y=t.y*e,n.z=t.z*e,n},E.divideByScalar=function(t,e,n){return n.x=t.x/e,n.y=t.y/e,n.z=t.z/e,n},E.negate=function(t,e){return e.x=-t.x,e.y=-t.y,e.z=-t.z,e},E.abs=function(t,e){return e.x=Math.abs(t.x),e.y=Math.abs(t.y),e.z=Math.abs(t.z),e};var s=new E;E.lerp=function(t,e,n,r){return E.multiplyByScalar(e,n,s),r=E.multiplyByScalar(t,1-n,r),E.add(s,r,r)};var h=new E,c=new E;E.angleBetween=function(t,e){E.normalize(t,h),E.normalize(e,c);t=E.dot(h,c),e=E.magnitude(E.cross(h,c,h));return Math.atan2(e,t)};var l=new E;E.mostOrthogonalAxis=function(t,e){t=E.normalize(t,l);return E.abs(t,t),e=t.x<=t.y?t.x<=t.z?E.clone(E.UNIT_X,e):E.clone(E.UNIT_Z,e):t.y<=t.z?E.clone(E.UNIT_Y,e):E.clone(E.UNIT_Z,e)},E.projectVector=function(t,e,n){t=E.dot(t,e)/E.dot(e,e);return E.multiplyByScalar(e,t,n)},E.equals=function(t,e){return t===e||I(t)&&I(e)&&Math.abs(t.x-e.x)<1e-10&&Math.abs(t.y-e.y)<1e-10&&Math.abs(t.z-e.z)<1e-10},E.equalsArray=function(t,e,n){return t.x===e[n]&&t.y===e[n+1]&&t.z===e[n+2]},E.equalsEpsilon=function(t,e,n,r){return t===e||I(t)&&I(e)&&S.equalsEpsilon(t.x,e.x,n,r)&&S.equalsEpsilon(t.y,e.y,n,r)&&S.equalsEpsilon(t.z,e.z,n,r)},E.cross=function(t,e,n){var r=t.x,i=t.y,o=t.z,a=e.x,u=e.y,t=e.z,e=o*a-r*t,a=r*u-i*a;return n.x=i*t-o*u,n.y=e,n.z=a,n},E.midpoint=function(t,e,n){return n.x=.5*(t.x+e.x),n.y=.5*(t.y+e.y),n.z=.5*(t.z+e.z),n},E.fromDegrees=function(t,e,n,r,i){return t=S.toRadians(t),e=S.toRadians(e),E.fromRadians(t,e,n,r,i)};var f=new E,d=new E,g=new E(40680631590769,40680631590769,40408299984661.445);E.fromRadians=function(t,e,n,r,i){n=m(n,0);var o=I(r)?r.radiiSquared:g,r=Math.cos(e);f.x=r*Math.cos(t),f.y=r*Math.sin(t),f.z=Math.sin(e),f=E.normalize(f,f),E.multiplyComponents(o,f,d);o=Math.sqrt(E.dot(f,d));return d=E.divideByScalar(d,o,d),f=E.multiplyByScalar(f,n,f),I(i)||(i=new E),E.add(d,f,i)},E.fromDegreesArray=function(t,e,n){var r=t.length;I(n)?n.length=r/2:n=new Array(r/2);for(var i=0;i<r;i+=2){var o=t[i],a=t[i+1],u=i/2;n[u]=E.fromDegrees(o,a,0,e,n[u])}return n},E.fromRadiansArray=function(t,e,n){var r=t.length;I(n)?n.length=r/2:n=new Array(r/2);for(var i=0;i<r;i+=2){var o=t[i],a=t[i+1],u=i/2;n[u]=E.fromRadians(o,a,0,e,n[u])}return n},E.fromDegreesArrayHeights=function(t,e,n){var r=t.length;I(n)?n.length=r/3:n=new Array(r/3);for(var i=0;i<r;i+=3){var o=t[i],a=t[i+1],u=t[i+2],s=i/3;n[s]=E.fromDegrees(o,a,u,e,n[s])}return n},E.fromRadiansArrayHeights=function(t,e,n){var r=t.length;I(n)?n.length=r/3:n=new Array(r/3);for(var i=0;i<r;i+=3){var o=t[i],a=t[i+1],u=t[i+2],s=i/3;n[s]=E.fromRadians(o,a,u,e,n[s])}return n},E.ZERO=Object.freeze(new E(0,0,0)),E.UNIT_X=Object.freeze(new E(1,0,0)),E.UNIT_Y=Object.freeze(new E(0,1,0)),E.UNIT_Z=Object.freeze(new E(0,0,1)),E.prototype.clone=function(t){return E.clone(this,t)},E.prototype.equals=function(t){return E.equals(this,t)},E.prototype.equalsEpsilon=function(t,e,n){return E.equalsEpsilon(this,t,e,n)},E.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},E.prototype.applyMatrix4=function(t,e,n){I(n)||(n=new E);var r=t.x,i=t.y,o=t.z,t=1/(e[3]*r+e[7]*i+e[11]*o+e[15]);return n.x=(e[0]*r+e[4]*i+e[8]*o+e[12])*t,n.y=(e[1]*r+e[5]*i+e[9]*o+e[13])*t,n.z=(e[2]*r+e[6]*i+e[10]*o+e[14])*t,n},E.prototype.set=function(t,e,n){this.x=t,this.y=e,this.z=n},E.prototype.fromArray=function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this.z=t[e+2],this},E.prototype.toArray=function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t};var R=new E,P=new E;function p(t,e,n,r,i){var o=t.x,a=t.y,u=t.z,s=e.x,h=e.y,e=e.z,c=o*o*s*s,l=a*a*h*h,f=u*u*e*e,s=c+l+f,h=Math.sqrt(1/s),e=E.multiplyByScalar(t,h,R);if(s<r)return isFinite(h)?E.clone(e,i):void 0;var d=n.x,m=n.y,g=n.z,n=P;n.x=e.x*d*2,n.y=e.y*m*2,n.z=e.z*g*2;var p=(1-h)*E.magnitude(t)/(.5*E.magnitude(n)),_=0;do{var v,y,w,x,M,b,O,_=(O=c*(x=(v=1/(1+(p-=_)*d))*v)+l*(M=(y=1/(1+p*m))*y)+f*(b=(w=1/(1+p*g))*w)-1)/(-2*(c*(x*v)*d+l*(M*y)*m+f*(b*w)*g))}while(Math.abs(O)>S.EPSILON12);return I(i)?(i.x=o*v,i.y=a*y,i.z=u*w,i):new E(o*v,a*y,u*w)}function _(t,e,n){this.longitude=m(t,0),this.latitude=m(e,0),this.height=m(n,0)}_.fromRadians=function(t,e,n,r){return n=m(n,0),I(r)?(r.longitude=t,r.latitude=e,r.height=n,r):new _(t,e,n)},_.fromDegrees=function(t,e,n,r){return t=S.toRadians(t),e=S.toRadians(e),_.fromRadians(t,e,n,r)};var v=new E,y=new E,w=new E,x=new E(1/6378137,1/6378137,1/6356752.314245179),M=new E(1/40680631590769,1/40680631590769,1/40408299984661.445),b=S.EPSILON1;function O(t,e,n,r){e=m(e,0),n=m(n,0),r=m(r,0),t._radii=new E(e,n,r),t._radiiSquared=new E(e*e,n*n,r*r),t._radiiToTheFourth=new E(e*e*e*e,n*n*n*n,r*r*r*r),t._oneOverRadii=new E(0===e?0:1/e,0===n?0:1/n,0===r?0:1/r),t._oneOverRadiiSquared=new E(0===e?0:1/(e*e),0===n?0:1/(n*n),0===r?0:1/(r*r)),t._minimumRadius=Math.min(e,n,r),t._maximumRadius=Math.max(e,n,r),t._centerToleranceSquared=S.EPSILON1,0!==t._radiiSquared.z&&(t._squaredXOverSquaredZ=t._radiiSquared.x/t._radiiSquared.z)}function A(t,e,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,O(this,t,e,n)}_.fromCartesian=function(t,e,n){var r=I(e)?e.oneOverRadii:x,i=I(e)?e.oneOverRadiiSquared:M,r=p(t,r,i,I(e)?e._centerToleranceSquared:b,y);if(I(r)){e=E.multiplyComponents(r,i,v),e=E.normalize(e,e),i=E.subtract(t,r,w),r=Math.atan2(e.y,e.x),e=Math.asin(e.z),i=S.sign(E.dot(i,t))*E.magnitude(i);return I(n)?(n.longitude=r,n.latitude=e,n.height=i,n):new _(r,e,i)}},_.toCartesian=function(t,e,n){return E.fromRadians(t.longitude,t.latitude,t.height,e,n)},_.clone=function(t,e){if(I(t))return I(e)?(e.longitude=t.longitude,e.latitude=t.latitude,e.height=t.height,e):new _(t.longitude,t.latitude,t.height)},_.equals=function(t,e){return t===e||I(t)&&I(e)&&t.longitude===e.longitude&&t.latitude===e.latitude&&t.height===e.height},_.equalsEpsilon=function(t,e,n){return n=m(n,0),t===e||I(t)&&I(e)&&Math.abs(t.longitude-e.longitude)<=n&&Math.abs(t.latitude-e.latitude)<=n&&Math.abs(t.height-e.height)<=n},_.ZERO=Object.freeze(new _(0,0,0)),_.prototype.clone=function(t){return _.clone(this,t)},_.prototype.equals=function(t){return _.equals(this,t)},_.prototype.equalsEpsilon=function(t,e){return _.equalsEpsilon(this,t,e)},_.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"},_.geodeticParallelLength=function(t,e,n){return t*n*Math.cos(e)},_.geodeticCircleRadians=function(t,e,n,r){r=Math.cos(e)*Math.cos(r)*Math.cos(t-n)+Math.sin(e)*Math.sin(r);return Math.abs(Math.acos(r))},_.add=function(t,e,n){return n.longitude=t.longitude+e.longitude,n.latitude=t.latitude+e.latitude,n.height=t.height+e.height,n},_.subtract=function(t,e,n){return n.longitude=t.longitude-e.longitude,n.latitude=t.latitude-e.latitude,n.height=t.height-e.height,n},_.multiplyByScalar=function(t,e,n){return n.longitude=t.longitude*e,n.latitude=t.latitude*e,n.height=t.height*e,n},_.divideByScalar=function(t,e,n){return n.longitude=t.longitude/e,n.latitude=t.latitude/e,n.height=t.height/e,n},_.distance=function(t,e){t=new Cartesian2(t.longitude,t.latitude),e=new Cartesian2(e.longitude,e.latitude);return Cartesian2.distance(t,e)},Object.defineProperties(A.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),A.clone=function(t,e){if(I(t)){var n=t._radii;return I(e)?(E.clone(n,e._radii),E.clone(t._radiiSquared,e._radiiSquared),E.clone(t._radiiToTheFourth,e._radiiToTheFourth),E.clone(t._oneOverRadii,e._oneOverRadii),E.clone(t._oneOverRadiiSquared,e._oneOverRadiiSquared),e._minimumRadius=t._minimumRadius,e._maximumRadius=t._maximumRadius,e._centerToleranceSquared=t._centerToleranceSquared,e):new A(n.x,n.y,n.z)}},A.fromCartesian3=function(t,e){return I(e)||(e=new A),I(t)&&O(e,t.x,t.y,t.z),e},A.WGS84=Object.freeze(new A(6378137,6378137,6356752.314245179)),A.UNIT_SPHERE=Object.freeze(new A(1,1,1)),A.MOON=Object.freeze(new A(S.LUNAR_RADIUS,S.LUNAR_RADIUS,S.LUNAR_RADIUS)),A.DATUM_PLANE=-100,A.prototype.clone=function(t){return A.clone(this,t)},A.packedLength=E.packedLength,A.pack=function(t,e,n){return n=m(n,0),E.pack(t._radii,e,n),e},A.unpack=function(t,e,n){e=m(e,0);e=E.unpack(t,e);return A.fromCartesian3(e,n)},A.prototype.geocentricSurfaceNormal=E.normalize,A.prototype.geodeticSurfaceNormalCartographic=function(t,e){var n=t.longitude,r=t.latitude,i=Math.cos(r),t=i*Math.cos(n),n=i*Math.sin(n),r=Math.sin(r);return(e=!I(e)?new E:e).x=t,e.y=n,e.z=r,E.normalize(e,e)},A.prototype.geodeticSurfaceNormal=function(t,e){if(!E.equalsEpsilon(t,E.ZERO,S.EPSILON14))return I(e)||(e=new E),e=E.multiplyComponents(t,this._oneOverRadiiSquared,e),E.normalize(e,e)};var z=new E,T=new E;A.prototype.cartographicToCartesian=function(t,e){var n=z,r=T;this.geodeticSurfaceNormalCartographic(t,n),E.multiplyComponents(this._radiiSquared,n,r);var i=Math.sqrt(E.dot(n,r));return E.divideByScalar(r,i,r),E.multiplyByScalar(n,t.height,n),I(e)||(e=new E),E.add(r,n,e)},A.prototype.cartographicArrayToCartesianArray=function(t,e){var n=t.length;I(e)?e.length=n:e=new Array(n);for(var r=0;r<n;r++)e[r]=this.cartographicToCartesian(t[r],e[r]);return e};var N=new E,q=new E,L=new E;A.prototype.cartesianToCartographic=function(t,e){var n=this.scaleToGeodeticSurface(t,q);if(I(n)){var r=this.geodeticSurfaceNormal(n,N),i=E.subtract(t,n,L),n=Math.atan2(r.y,r.x),r=Math.asin(r.z),i=S.sign(E.dot(i,t))*E.magnitude(i);return I(e)?(e.longitude=n,e.latitude=r,e.height=i,e):new _(n,r,i)}},A.prototype.cartesianArrayToCartographicArray=function(t,e){var n=t.length;I(e)?e.length=n:e=new Array(n);for(var r=0;r<n;++r)e[r]=this.cartesianToCartographic(t[r],e[r]);return e},A.prototype.scaleToGeodeticSurface=function(t,e){return p(t,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,e)},A.prototype.scaleToGeocentricSurface=function(t,e){I(e)||(e=new E);var n=t.x,r=t.y,i=t.z,o=this._oneOverRadiiSquared,o=1/Math.sqrt(n*n*o.x+r*r*o.y+i*i*o.z);return E.multiplyByScalar(t,o,e)},A.prototype.transformPositionToScaledSpace=function(t,e){return I(e)||(e=new E),E.multiplyComponents(t,this._oneOverRadii,e)},A.prototype.transformPositionFromScaledSpace=function(t,e){return I(e)||(e=new E),E.multiplyComponents(t,this._radii,e)},A.prototype.equals=function(t){return this===t||I(t)&&E.equals(this._radii,t._radii)},A.prototype.toString=function(){return this._radii.toString()},A.prototype.getSurfaceNormalIntersectionWithZAxis=function(t,e,n){e=m(e,0);var r=this._squaredXOverSquaredZ;if((n=!I(n)?new E:n).x=0,n.y=0,n.z=t.z*(1-r),!(Math.abs(n.z)>=this._radii.z-e))return n};var C=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],W=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function U(t,e,n){for(var r=.5*(e+t),i=.5*(e-t),o=0,a=0;a<5;a++){var u=i*C[a];o+=W[a]*(n(r+u)+n(r-u))}return o*=i}function k(t,e,n,r,i,o){this.west=m(t,Math.PI),this.south=m(e,Math.PI/2),this.east=m(n,-Math.PI),this.north=m(r,-Math.PI/2),this.minHeight=m(i,0),this.maxHeight=m(o,0)}A.prototype.surfaceArea=function(t){for(var e=t.west,i=t.east,n=t.south,r=t.north;i<e;)i+=S.TWO_PI;var t=this._radiiSquared,o=t.x,a=t.y,u=t.z,s=o*a;return U(n,r,function(t){var n=Math.cos(t),r=Math.sin(t);return Math.cos(t)*U(e,i,function(t){var e=Math.cos(t),t=Math.sin(t);return Math.sqrt(s*r*r+u*(a*e*e+o*t*t)*n*n)})})},Object.defineProperties(k.prototype,{width:{get:function(){return k.computeWidth(this)}},height:{get:function(){return k.computeHeight(this)}}}),k.packedLength=4,k.pack=function(t,e,n){return n=m(n,0),e[n++]=t.west,e[n++]=t.south,e[n++]=t.east,e[n]=t.north,e},k.unpack=function(t,e,n){return e=m(e,0),(n=!I(n)?new k:n).west=t[e++],n.south=t[e++],n.east=t[e++],n.north=t[e],n},k.computeWidth=function(t){var e=t.east,t=t.west;return e<t&&(e+=S.TWO_PI),e-t},k.computeHeight=function(t){return t.north-t.south},k.fromDegrees=function(t,e,n,r,i){return t=S.toRadians(m(t,0)),e=S.toRadians(m(e,0)),n=S.toRadians(m(n,0)),r=S.toRadians(m(r,0)),I(i)?(i.west=t,i.south=e,i.east=n,i.north=r,i):new k(t,e,n,r)},k.fromRadians=function(t,e,n,r,i){return I(i)?(i.west=m(t,0),i.south=m(e,0),i.east=m(n,0),i.north=m(r,0),i):new k(t,e,n,r)},k.fromCartographicArray=function(t,e){for(var n=Number.MAX_VALUE,r=-Number.MAX_VALUE,i=Number.MAX_VALUE,o=-Number.MAX_VALUE,a=Number.MAX_VALUE,u=-Number.MAX_VALUE,s=0,h=t.length;s<h;s++)var c=t[s],n=Math.min(n,c.longitude),r=Math.max(r,c.longitude),a=Math.min(a,c.latitude),u=Math.max(u,c.latitude),c=0<=c.longitude?c.longitude:c.longitude+S.TWO_PI,i=Math.min(i,c),o=Math.max(o,c);return o-i<r-n&&(n=i,(r=o)>S.PI&&(r-=S.TWO_PI),n>S.PI&&(n-=S.TWO_PI)),I(e)?(e.west=n,e.south=a,e.east=r,e.north=u,e):new k(n,a,r,u)},k.fromCartesianArray=function(t,e,n){e=m(e,A.WGS84);for(var r=Number.MAX_VALUE,i=-Number.MAX_VALUE,o=Number.MAX_VALUE,a=-Number.MAX_VALUE,u=Number.MAX_VALUE,s=-Number.MAX_VALUE,h=Number.MAX_VALUE,c=-Number.MAX_VALUE,l=0,f=t.length;l<f;l++)var d=e.cartesianToCartographic(t[l]),r=Math.min(r,d.longitude),i=Math.max(i,d.longitude),u=Math.min(u,d.latitude),s=Math.max(s,d.latitude),h=Math.min(h,d.height),c=Math.max(c,d.height),d=0<=d.longitude?d.longitude:d.longitude+S.TWO_PI,o=Math.min(o,d),a=Math.max(a,d);return a-o<i-r&&(r=o,(i=a)>S.PI&&(i-=S.TWO_PI),r>S.PI&&(r-=S.TWO_PI)),I(n)?(n.west=r,n.south=u,n.east=i,n.north=s,n.minHeight=h,n.maxHeight=c,n):new k(r,u,i,s,h,c)},k.clone=function(t,e){if(I(t))return I(e)?(e.west=t.west,e.south=t.south,e.east=t.east,e.north=t.north,e.minHeight=t.minHeight,e.maxHeight=t.maxHeight,e):new k(t.west,t.south,t.east,t.north,t.minHeight,t.maxHeight)},k.equalsEpsilon=function(t,e,n){return n=m(n,0),t===e||I(t)&&I(e)&&Math.abs(t.west-e.west)<=n&&Math.abs(t.south-e.south)<=n&&Math.abs(t.east-e.east)<=n&&Math.abs(t.north-e.north)<=n&&Math.abs(t.minHeight-e.minHeight)<=n&&Math.abs(t.maxHeight-e.maxHeight)<=n},k.prototype.clone=function(t){return k.clone(this,t)},k.prototype.equals=function(t){return k.equals(this,t)},k.prototype.intersect=function(t){return k.intersect(this,t)},k.equals=function(t,e){return t===e||I(t)&&I(e)&&t.west===e.west&&t.south===e.south&&t.east===e.east&&t.north===e.north},k.prototype.equalsEpsilon=function(t,e){return k.equalsEpsilon(this,t,e)},k.validate=function(t){},k.southwest=function(t,e){return I(e)?(e.longitude=t.west,e.latitude=t.south,e.height=0,e):new _(t.west,t.south)},k.northwest=function(t,e){return I(e)?(e.longitude=t.west,e.latitude=t.north,e.height=0,e):new _(t.west,t.north)},k.northeast=function(t,e){return I(e)?(e.longitude=t.east,e.latitude=t.north,e.height=0,e):new _(t.east,t.north)},k.southeast=function(t,e){return I(e)?(e.longitude=t.east,e.latitude=t.south,e.height=0,e):new _(t.east,t.south)},k.center=function(t,e){var n=t.east,r=t.west;n<r&&(n+=S.TWO_PI);n=S.negativePiToPi(.5*(r+n)),t=.5*(t.south+t.north);return I(e)?(e.longitude=n,e.latitude=t,e.height=0,e):new _(n,t)},k.intersection=function(t,e,n){var r=t.east,i=t.west,o=e.east,a=e.west;r<i&&0<o?r+=S.TWO_PI:o<a&&0<r&&(o+=S.TWO_PI),r<i&&a<0?a+=S.TWO_PI:o<a&&i<0&&(i+=S.TWO_PI);a=S.negativePiToPi(Math.max(i,a)),r=S.negativePiToPi(Math.min(r,o));if(!((t.west<t.east||e.west<e.east)&&r<=a)){o=Math.max(t.south,e.south),e=Math.min(t.north,e.north);if(!(e<=o))return I(n)?(n.west=a,n.south=o,n.east=r,n.north=e,n):new k(a,o,r,e)}},k.simpleIntersection=function(t,e,n){var r=Math.max(t.west,e.west),i=Math.max(t.south,e.south),o=Math.min(t.east,e.east),e=Math.min(t.north,e.north);if(!(e<=i||o<=r))return I(n)?(n.west=r,n.south=i,n.east=o,n.north=e,n):new k(r,i,o,e)},k.union=function(t,e,n){I(n)||(n=new k);var r=t.east,i=t.west,o=e.east,a=e.west;r<i&&0<o?r+=S.TWO_PI:o<a&&0<r&&(o+=S.TWO_PI),r<i&&a<0?a+=S.TWO_PI:o<a&&i<0&&(i+=S.TWO_PI);a=S.convertLongitudeRange(Math.min(i,a)),o=S.convertLongitudeRange(Math.max(r,o));return n.west=a,n.south=Math.min(t.south,e.south),n.east=o,n.north=Math.max(t.north,e.north),n},k.expand=function(t,e,n){return(n=!I(n)?new k:n).west=Math.min(t.west,e.longitude),n.south=Math.min(t.south,e.latitude),n.east=Math.max(t.east,e.longitude),n.north=Math.max(t.north,e.latitude),n},k.contains=function(t,e){var n=e.longitude,r=e.latitude,i=t.west,e=t.east;return e<i&&(e+=S.TWO_PI,n<0&&(n+=S.TWO_PI)),(i<n||S.equalsEpsilon(n,i,S.EPSILON14))&&(n<e||S.equalsEpsilon(n,e,S.EPSILON14))&&r>=t.south&&r<=t.north};var V=new _;k.subsample=function(t,e,n,r){e=m(e,A.WGS84),n=m(n,0),I(r)||(r=[]);var i=0,o=t.north,a=t.south,u=t.east,s=t.west,h=V;h.height=n,h.longitude=s,h.latitude=o,r[i]=e.cartographicToCartesian(h,r[i]),i++,h.longitude=u,r[i]=e.cartographicToCartesian(h,r[i]),i++,h.latitude=a,r[i]=e.cartographicToCartesian(h,r[i]),i++,h.longitude=s,r[i]=e.cartographicToCartesian(h,r[i]),i++,h.latitude=o<0?o:0<a?a:0;for(var c=1;c<8;++c)h.longitude=-Math.PI+c*S.PI_OVER_TWO,k.contains(t,h)&&(r[i]=e.cartographicToCartesian(h,r[i]),i++);return 0===h.latitude&&(h.longitude=s,r[i]=e.cartographicToCartesian(h,r[i]),i++,h.longitude=u,r[i]=e.cartographicToCartesian(h,r[i]),i++),r.length=i,r},k.intersect=function(t,e){return t.north>=e.south&&t.south<=e.north&&t.east>=e.west&&t.west<=e.east},k.intersect_lon_lat_region=function(t,e){for(var n=e.get_count(),r=0;r<n;r++)if(k.check_rect_line(t,e.getItem(r),e.getItem((r+1)%n)))return!0;return!!e.containRect(t)},k.check_rect_line_vertical=function(t,e,n,r,i){if(n<t.longitude&&n<e.longitude)return!1;if(n>t.longitude&&n>e.longitude)return!1;if(t.longitude==e.longitude)return n==t.longitude&&(!(t.latitude<r&&e.latitude<r)&&!(t.latitude>i&&e.latitude>i));t=(e.latitude-t.latitude)*(n-t.longitude)/(e.longitude-t.longitude)+t.latitude;return r<=t&&t<=i},k.check_rect_line_horizontal=function(t,e,n,r,i){if(n<t.latitude&&n<e.latitude)return!1;if(n>t.latitude&&n>e.latitude)return!1;if(t.latitude==e.latitude)return n==t.latitude&&(!(t.longitude<r&&e.longitude<r)&&!(t.longitude>i&&e.longitude>i));t=(e.longitude-t.longitude)*(n-t.latitude)/(e.latitude-t.latitude)+t.longitude;return r<=t&&t<=i},k.check_rect_line=function(t,e,n){var r=!1;return k.containPoint(t,e)||k.containPoint(t,n)?r=!0:(r|=k.check_rect_line_horizontal(e,n,t.north,t.west,t.east),r|=k.check_rect_line_horizontal(e,n,t.south,t.west,t.east),r|=k.check_rect_line_vertical(e,n,t.west,t.south,t.north),r|=k.check_rect_line_vertical(e,n,t.east,t.south,t.north)),r},k.intersectAabb=function(t,e){for(var n=new k,r=e.get_corners(),i=new _,o=0;o<8;o++){var a=_.fromCartesian(r[o],void 0,i);k.combine(n,a)}return k.intersect(t,n)},k.fromGeoAabb=function(t){for(var e=new k,n=t.get_corners(),r=new _,i=0;i<8;i++){var o=_.fromCartesian(n[i],void 0,r);k.combine(e,o)}return e},k.containsRect=function(t,e){var n=S.EPSILON6;return e.east<=t.east+n&&e.west>=t.west-n&&e.north<=t.north+n&&e.south>=t.south-n},k.combine=function(t,e){t.west>e.longitude&&(t.west=e.longitude),t.east<e.longitude&&(t.east=e.longitude),t.north<e.latitude&&(t.north=e.latitude),t.south>e.latitude&&(t.south=e.latitude),t.maxHeight<e.height&&(t.maxHeight=e.height),t.minHeight>e.height&&(t.minHeight=e.height)},k.fromAabb=function(t,e){var n=e.minimum,r=e.maximum,i=r.z/A.WGS84.maximumRadius*1e3,e=n.z/A.WGS84.maximumRadius*1e3,r=r.x/A.WGS84.maximumRadius*1e3,n=n.x/A.WGS84.maximumRadius*1e3;return new k(t.longitude+n,t.latitude+e,t.longitude+r,t.latitude+i)},k.containPoint=function(t,e){return e.longitude<=t.east&&e.longitude>=t.west&&e.latitude<=t.north&&e.latitude>=t.south},k.MAX_VALUE=Object.freeze(new k(-Math.PI,-S.PI_OVER_TWO,Math.PI,S.PI_OVER_TWO));var D=0,j=1,F=2,B=3,H=4,G={};function X(t){this._bound=m((t=null==t?{}:t).bound,void 0),this._level=m(t.level,void 0),this._index=m(t.index,void 0),this._quadrant=m(t.quadrant,void 0),this.orientedBoundingBox=void 0,this.minimumHeight=0,this.boundingVolumeLevel=void 0,this.tileBoundingRegion=void 0,this.isClipped=!1,this._geoCornerArray=void 0}G.worldRect=new k(-S.PI,-S.PI_OVER_TWO,S.PI,S.PI_OVER_TWO),G.assemble_int=function(t,e,n){return{level:t,lonIndex:e,latIndex:n}},G.assemble=function(t,e,n){var r=1/G.get_bound_size(t),e=Math.floor((e-G.worldRect.west)*r),r=Math.floor((n-G.worldRect.south)*r);return G.assemble_int(t,e,r)},G.get_bound_size=function(t){return(G.worldRect.east-G.worldRect.west)/(1<<t+1)},G.toString=function(t){var e=t.level.toString(16),n=t.lonIndex.toString(16),r=t.latIndex.toString(16),r=0===t.level?0===t.lonIndex?r:n+"000000".substring(0,6-r.length)+r:e+"000000".substring(0,6-n.length)+n+"000000".substring(0,6-r.length)+r;return r},G.to_string=function(t){var e=t.level,n=t.lonIndex,r=t.latIndex,i=(16711680&n)>>16,o=(65280&n)>>8,n=(16711680&r)>>16,r=(65280&r)>>8,t=G.toString(t);return e.toString(16)+"/"+i.toString(16)+n.toString(16)+"/"+o.toString(16)+r.toString(16)+"/"+t},G.to_int=function(t){var e=t.level,n=t.lonIndex,t=t.latIndex;return e<<48||n<<24||t},G.to_path=function(t,e,n){var r=G.assemble(t,e,n),t=r.level,e=r.lonIndex,n=r.latIndex,t=(65280&e)>>8,r=(16711680&n)>>16,n=(65280&n)>>8;return{x:((16711680&e)>>16).toString(16)+r.toString(16),y:t.toString(16)+n.toString(16)}},G.get_level=function(t){return t.level},G.get_lat_index=function(t){return t.latIndex},G.get_lon_index=function(t){return t.lonIndex},G.get_bound=function(t,e){var n=t.level,r=t.lonIndex,i=t.latIndex,o=r+1,t=i+1,n=G.get_bound_size(n),r=r*n+G.worldRect.west,i=i*n+G.worldRect.south,o=o*n+G.worldRect.west,n=t*n+G.worldRect.south;return I(e)?(e.west=r,e.south=i,e.east=o,e.north=n,e):new k(r,i,o,n,0,0)},G.get_parent_index=function(t,e){I(e)||(e=1);var n=t.level,r=t.lonIndex,t=t.latIndex;return G.assemble_int(n-e,r>>e,t>>e)},G.get_children=function(t,e){var n=t.level+1,r=2*t.lonIndex,i=2*t.latIndex,o=G.assemble_int(n,r,i),a=G.assemble_int(n,r,1+i),t=G.assemble_int(n,1+r,i),i=G.assemble_int(n,1+r,1+i);if(!I(e))return[o,a,t,i];e[0]=o,e[1]=a,e[2]=t,e[3]=i},G.get_child=function(t,e){var n=t.level+1,r=t.lonIndex<<1,i=t.latIndex<<1,o=0;switch(e){case D:o=G.assemble_int(n,r,i);break;case j:o=G.assemble_int(n,r,1+i);break;case F:o=G.assemble_int(n,1+r,i);break;case B:o=G.assemble_int(n,1+r,1+i)}return o},Object.defineProperties(X.prototype,{index:{get:function(){return this._index}},level:{get:function(){return this._level}},bound:{get:function(){return this._bound}},quadrant:{get:function(){return this._quadrant},set:function(t){this._quadrant=t}}}),X.prototype.initFromInteriorIndex=function(t){this._index=t,this._level=G.get_level(t),this._bound=G.get_bound(t)},X.prototype.initFromLevelAndRect=function(t,e){this._bound=k.clone(t),this._level=e;t=k.center(t);this._index=G.assemble(e,t.longitude,t.latitude)},X.prototype.initFromLevelRectparamsAndQuadrant=function(t,e,n,r,i,o){this._bound=new k(i,n,r,e),this._level=t;e=k.center(this._bound);this._index=G.assemble(t,e.longitude,e.latitude),I(o)&&(this._quadrant=o)};var Z,K=new E;function Y(){this._nsres=1,this._ewres=1,this._scale=1,this._slopeFormat=1}function J(){}function Q(){}function $(t,e,n,r){return tt(t).then(e,n,r)}function tt(t){var e,n,t=t instanceof et?t:it(t)?(e=rt(),t.then(function(t){e.resolve(t)},function(t){e.reject(t)},function(t){e.progress(t)}),e.promise):(n=t,new et(function(t){try{return tt(t?t(n):n)}catch(t){return nt(t)}}));return t}function et(t){this.then=t}function nt(n){return new et(function(t,e){try{return e?tt(e(n)):nt(n)}catch(t){return nt(t)}})}function rt(){var t=new et(i),a=[],u=[],r=function(e,n,r){var i=rt(),o="function"==typeof r?function(t){try{i.progress(r(t))}catch(t){i.progress(t)}}:function(t){i.progress(t)};return a.push(function(t){t.then(e,n).then(i.resolve,i.reject,o)}),u.push(o),i.promise},e=function(t){return st(u,t),t},n=function(t){return t=tt(t),r=t.then,n=tt,e=ht,st(a,t),u=a=Z,t};return{then:i,resolve:o,reject:s,progress:h,promise:t,resolver:{resolve:o,reject:s,progress:h}};function i(t,e,n){return r(t,e,n)}function o(t){return n(t)}function s(t){return n(nt(t))}function h(t){return e(t)}}function it(t){return t&&"function"==typeof t.then}function ot(t,d,m,g,p){return $(t,function(t){var e,n,r,i,o=t.length>>>0,a=Math.max(0,Math.min(d,o)),u=[],s=o-a+1,h=[],c=rt();if(a)for(r=c.progress,n=function(t){h.push(t),--s||(e=n=ht,c.reject(h))},e=function(t){u.push(t),--a||(e=n=ht,c.resolve(u))},i=0;i<o;++i)i in t&&$(t[i],f,l,r);else c.resolve(u);return c.then(m,g,p);function l(t){n(t)}function f(t){e(t)}})}function at(t,e,n,r){return ut(t,ct).then(e,n,r)}function ut(t,u){return $(t,function(t){var e,n,r,i=e=t.length>>>0,o=[],a=rt();if(i)for(n=function(t,e){$(t,u).then(function(t){o[e]=t,--i||a.resolve(o)},a.reject)},r=0;r<e;r++)r in t?n(t[r],r):--i;else a.resolve(o);return a.promise})}function st(t,e){for(var n,r=0;n=t[r++];)n(e)}function ht(){}function ct(t){return t}X.prototype.culling_by_normal=function(t,e){var n;void 0===this._geoCornerArray&&(this._geoCornerArray=new Array(4),e=void 0!==e?e:A.WGS84,n=new _(this._bound.west,this._bound.north,0),this._geoCornerArray[0]=e.cartographicToCartesian(n),n=new _(this._bound.west,this._bound.south,0),this._geoCornerArray[1]=e.cartographicToCartesian(n),n=new _(this._bound.east,this._bound.north,0),this._geoCornerArray[2]=e.cartographicToCartesian(n),n=new _(this._bound.east,this._bound.south,0),this._geoCornerArray[3]=e.cartographicToCartesian(n));var r=E.subtract(t.originGeoWC,t.positionWC,K);E.normalize(r,r),E.multiplyByScalar(r,-1,r);for(var i=0;i<H;i++)if(0<=E.dot(r,this._geoCornerArray[i]))return!0;return!1},X.createFromInteriorIndex=function(t,e){return(e=!I(e)?new X:e).initFromInteriorIndex(t),e},X.createFromLevelAndRect=function(t,e,n){return(n=!I(n)?new X:n).initFromLevelAndRect(t,e),n},X.createFromLevelAndRectparams=function(t,e,n,r,i,o){return(o=!I(o)?new X:o).initFromLevelRectparamsAndQuadrant(t,e,n,r,i),o},Object.defineProperties(Y.prototype,{nsres:{get:function(){return this._nsres},set:function(t){this._nsres=t}},ewres:{get:function(){return this._ewres},set:function(t){this._ewres=t}},scale:{get:function(){return this._scale},set:function(t){this._scale=t}},slopeFormat:{get:function(){return this._slopeFormat},set:function(t){this._slopeFormat=t}}}),J.create_slope=function(t,e,n){var n=n.level,r=new Y;r.ewres=.6,15<n?r.ewres=r.ewres/(1<<n-15):n<15&&(r.ewres=r.ewres*(1<<15-n)),r.nsres=r.ewres;for(var i=new Array(9),o=0;o<33;o++){var a=33*o,u=a-33,s=33+a;0==o&&(u=a),32==o&&(s=a);for(var h=0;h<33;h++){var c=h-1,l=h,f=32==h?l:h+1;i[0]=e[u+(c=0==h?l:c)],i[1]=e[u+l],i[2]=e[u+f],i[3]=e[a+c],i[4]=e[a+l],i[5]=e[a+f],i[6]=e[s+c],i[7]=e[s+l],i[8]=e[s+f],t[a+h]=J.generate_slope_horn(i,r)}}},J.generate_slope_horn=function(t,e){var n=(t[0]+t[3]+t[3]+t[6]-(t[2]+t[5]+t[5]+t[8]))/e.ewres,t=(t[6]+t[7]+t[7]+t[8]-(t[0]+t[1]+t[1]+t[2]))/e.nsres,t=n*n+t*t;return 1==e.slopeFormat?Math.atan(Math.sqrt(t)/(8*e.scale))*S.DEGREES_PER_RADIAN:Math.sqrt(t)/(8*e.scale)*100},J.generate_slope_zeven=function(t,e){var n=(t[3]-t[5])/e.ewres,t=(t[7]-t[1])/e.nsres,t=n*n+t*t;return 1==e.slopeFormat?Math.atan(Math.sqrt(t)/(2*e.scale))*S.DEGREES_PER_RADIAN:Math.sqrt(t)/(2*e.scale)*100},Q.calculate_slope=function(t){var e=[];if(e.length=1089,t.is_height)for(var n=0;n<1089;++n)e[n]=t.gridbuffer[n];else J.create_slope(e,t.gridbuffer,t.index);var r=[],i=[];return i.length=4,Q.init_subsquare(r,i,t.offset),Q.generate_vertex(t.index,t.offset,i,t.centers),Q.generate_triangle(r,t.offset),{indexes:r,sub_squares:i,buffer:e}},Q.init_subsquare=function(t,e,n){var n=17+n,r=n*n;t.length=2*(n-1)*3*(n-1);for(var i=0;i<4;i++)e[i]={},e[i].vertexes=[],e[i].vertexes.length=7*r},Q.generate_triangle=function(t,e){for(var n=17+e,r=0,i=0;i<n-1;i++)for(var o=i*n,a=0;a<n-1;a++)t[r++]=o+a,t[r++]=o+a+1,t[r++]=o+a+1+n,t[r++]=o+a+1+n,t[r++]=o+a+n,t[r++]=o+a},Q.generate_vertex=function(t,e,n,r){var i=new X(t);i.initFromInteriorIndex(t);for(var o=1/32*i.bound.width,a=1/32*i.bound.height,u=17+e,t=Math.floor(16.5),s=t+e,h=t-e,c=0,l=0;l<33;l++)for(var f=0;f<33;f++){var d=new _(i.bound.west+f*o,i.bound.south+l*a,0),d=E.fromRadians(d.longitude,d.latitude,d.height);l<=s&&f<=s&&(c=7*(l*u+f),n[0].vertexes[c++]=d.x-r[0].x,n[0].vertexes[c++]=d.y-r[0].y,n[0].vertexes[c++]=d.z-r[0].z),h<=l&&f<=s&&(c=7*((l-h)*u+f),n[1].vertexes[c++]=d.x-r[1].x,n[1].vertexes[c++]=d.y-r[1].y,n[1].vertexes[c++]=d.z-r[1].z),l<=s&&h<=f&&(c=7*(l*u+(f-h)),n[2].vertexes[c++]=d.x-r[2].x,n[2].vertexes[c++]=d.y-r[2].y,n[2].vertexes[c++]=d.z-r[2].z),h<=l&&h<=f&&(c=7*((l-h)*u+(f-h)),n[3].vertexes[c++]=d.x-r[3].x,n[3].vertexes[c++]=d.y-r[3].y,n[3].vertexes[c++]=d.z-r[3].z)}},$.defer=rt,$.resolve=tt,$.reject=function(t){return $(t,nt)},$.join=function(){return ut(arguments,ct)},$.all=at,$.map=ut,$.reduce=function(t,o){var e=dt.call(arguments,1);return $(t,function(t){var i=t.length;return e[0]=function(t,n,r){return $(t,function(e){return $(n,function(t){return o(e,t,r,i)})})},mt.apply(t,e)})},$.any=function(t,e,n,r){return ot(t,1,function(t){return e?e(t[0]):t[0]},n,r)},$.some=ot,$.chain=function(t,e,n){var r=2<arguments.length;return $(t,function(t){return e.resolve(t=r?n:t),t},function(t){return e.reject(t),nt(t)},e.progress)},$.isPromise=it,et.prototype={always:function(t,e){return this.then(t,t,e)},otherwise:function(t){return this.then(Z,t)},yield:function(t){return this.then(function(){return t})},spread:function(e){return this.then(function(t){return at(t,function(t){return e.apply(Z,t)})})}};var lt,ft,dt=[].slice,mt=[].reduce||function(t){var e,n=0,r=Object(this),i=r.length>>>0,o=arguments;if(o.length<=1)for(;;){if(n in r){e=r[n++];break}if(++n>=i)throw new TypeError}else e=o[1];for(;n<i;++n)n in r&&(e=t(e,r[n],n,r));return e};return lt=function(t,e){return Q.calculate_slope(t)},function(t){var i=t.data,o=[],a={id:i.id,result:void 0,error:void 0};return $(function(t,e,n){try{return t(e,n)}catch(t){return $.reject(t)}}(lt,i.parameters,o)).then(function(t){a.result=t}).otherwise(function(t){t instanceof Error?a.error={name:t.name,message:t.message,stack:t.stack}:a.error=t}).always(function(){I(ft)||(ft=m(self.webkitPostMessage,self.postMessage)),i.canTransferArrayBuffer||(o.length=0);try{ft(a,o)}catch(t){a.result=void 0,a.error="postMessage failed with error: "+(n=(e=t).name,r=e.message,r=I(n)&&I(r)?n+": "+r:e.toString(),I(e=e.stack)&&(r+="\n"+e),r)+"\n    with responseMessage: "+JSON.stringify(a),ft(a)}var e,n,r})}});
